"use strict";function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var loadConfig=function(){var n={};return{set:function(e,t){n[e]=t},get:function(e){return n[e]},remove:function(e){return n[e]}}},DATA_HASH_ID="data-hash-id",pluginConfig=loadConfig(),findById=function(e,t){return document.querySelector("#".concat(e,"[").concat(DATA_HASH_ID,'="').concat(t,'"]'))},addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},hasClass=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},setAttributes=function(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})},triggerEvent=function(e,t){var n;e.fireEvent?e.fireEvent("on"+t):((n=document.createEvent("Events")).initEvent(t,!0,!1),e.dispatchEvent(n))},searchParentHashId=function(e,t){for(var n=!1,r=e;1===r.nodeType&&r&&!1===n;)!0===r.hasAttribute(t)?n=!0:r=r.parentNode;return!0===n?r.getAttribute(t):""},searchParent=function(e,t,n){for(var r=!1,i=e;i&&!1===r;)!0===hasClass(i,t)&&i.getAttribute(DATA_HASH_ID)===n?r=!0:i=i.parentNode;return!0===r?i.getAttribute("id"):""},plugin=function(){var s=_objectSpread({HIDESHOW_EXPAND:"js-expandmore",HIDESHOW_BUTTON_EXPAND:"js-expandmore-button",HIDESHOW_BUTTON_EXPAND_STYLE:"expandmore__button",HIDESHOW_BUTTON_LABEL_ID:"label_expand_",DATA_PREFIX_CLASS:"data-hideshow-prefix-class",HIDESHOW_BUTTON_EMPTY_ELEMENT_SYMBOL:"expandmore__symbol",HIDESHOW_BUTTON_EMPTY_ELEMENT_TAG:"span",ATTR_HIDESHOW_BUTTON_EMPTY_ELEMENT:"aria-hidden",HIDESHOW_TO_EXPAND_ID:"expand_",HIDESHOW_TO_EXPAND_STYLE:"expandmore__to_expand",ATTR_CONTROL:"data-controls",ATTR_EXPANDED:"aria-expanded",ATTR_LABELLEDBY:"data-labelledby",ATTR_HIDDEN:"data-hidden",IS_OPENED_CLASS:"is-opened",DISPLAY_FIRST_LOAD:"js-first_load",DISPLAY_FIRST_LOAD_DELAY:"1500"},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),E=Math.random().toString(32).slice(2,12);pluginConfig.set(E,s);return{attach:function(e){!function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;return[].slice.call(e.querySelectorAll("."+s.HIDESHOW_EXPAND))}(e).forEach(function(e){var t,n=Math.random().toString(32).slice(2,12),r=!0===e.hasAttribute(s.DATA_PREFIX_CLASS)?e.getAttribute(s.DATA_PREFIX_CLASS)+"-":"",i=e.nextElementSibling,a=e.innerHTML,_=document.createElement("BUTTON"),o=document.createElement(s.HIDESHOW_BUTTON_EMPTY_ELEMENT_TAG);e.setAttribute(DATA_HASH_ID,E),addClass(o,r+s.HIDESHOW_BUTTON_EMPTY_ELEMENT_SYMBOL),setAttributes(o,(_defineProperty(t={},s.ATTR_HIDESHOW_BUTTON_EMPTY_ELEMENT,!0),_defineProperty(t,DATA_HASH_ID,E),t)),e.innerHTML="",addClass(_,r+s.HIDESHOW_BUTTON_EXPAND_STYLE),addClass(_,s.HIDESHOW_BUTTON_EXPAND),setAttributes(_,(_defineProperty(t={},s.ATTR_CONTROL,s.HIDESHOW_TO_EXPAND_ID+n),_defineProperty(t,s.ATTR_EXPANDED,"false"),_defineProperty(t,"id",s.HIDESHOW_BUTTON_LABEL_ID+n),_defineProperty(t,"type","button"),_defineProperty(t,DATA_HASH_ID,E),t)),_.innerHTML=a,e.appendChild(_),_.insertBefore(o,_.firstChild),setAttributes(i,(_defineProperty(o={},s.ATTR_LABELLEDBY,s.HIDESHOW_BUTTON_LABEL_ID+n),_defineProperty(o,s.ATTR_HIDDEN,"true"),_defineProperty(o,"id",s.HIDESHOW_TO_EXPAND_ID+n),_defineProperty(o,DATA_HASH_ID,E),o)),addClass(i,r+s.HIDESHOW_TO_EXPAND_STYLE),!0===hasClass(i,s.DISPLAY_FIRST_LOAD)&&setTimeout(function(){removeClass(i,s.DISPLAY_FIRST_LOAD)},s.DISPLAY_FIRST_LOAD_DELAY),!0===hasClass(i,s.IS_OPENED_CLASS)&&(addClass(_,s.IS_OPENED_CLASS),_.setAttribute(s.ATTR_EXPANDED,"true"),removeClass(i,s.IS_OPENED_CLASS),i.removeAttribute(s.ATTR_HIDDEN))})}}},main=function(){return["click","keydown"].forEach(function(a){document.body.addEventListener(a,function(e){var t=searchParentHashId(e.target,DATA_HASH_ID);if(""!==t){var n=pluginConfig.get(t),r=searchParent(e.target,n.HIDESHOW_BUTTON_EXPAND,t);if(""!==r&&"click"===a&&(r=findById(r,t),i=findById(r.getAttribute(n.ATTR_CONTROL),t),"false"===r.getAttribute(n.ATTR_EXPANDED)?(r.setAttribute(n.ATTR_EXPANDED,!0),addClass(r,n.IS_OPENED_CLASS),i.removeAttribute(n.ATTR_HIDDEN)):(r.setAttribute(n.ATTR_EXPANDED,!1),removeClass(r,n.IS_OPENED_CLASS),i.setAttribute(n.ATTR_HIDDEN,!0))),!0===hasClass(e.target,n.HIDESHOW_EXPAND)){var i=e.target,n=i.querySelector("."+n.HIDESHOW_BUTTON_EXPAND);if(i!=n)return"click"!==a&&("keydown"!==a||13!==e.keyCode&&32!==e.keyCode)?void 0:(triggerEvent(n,"click"),!1)}}},!0)}),plugin};window.van11yAccessibleHideShowAria=main();var onLoad=function e(){window.van11yAccessibleHideShowAria().attach(),document.removeEventListener("DOMContentLoaded",e)};document.addEventListener("DOMContentLoaded",onLoad);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcmllcy1kZXRhaWxzLmpzIl0sIm5hbWVzIjpbImxvYWRDb25maWciLCJDQUNIRSIsImlkIiwic2V0IiwiY29uZmlnIiwiZ2V0IiwicmVtb3ZlIiwicGx1Z2luQ29uZmlnIiwiZmluZEJ5SWQiLCJoYXNoIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29uY2F0IiwiREFUQV9IQVNIX0lEIiwiZWwiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRDbGFzcyIsInJlcGxhY2UiLCJSZWdFeHAiLCJzcGxpdCIsImpvaW4iLCJoYXNDbGFzcyIsImNvbnRhaW5zIiwicmVtb3ZlQ2xhc3MiLCJ0ZXN0Iiwic2V0QXR0cmlidXRlcyIsIk9iamVjdCIsImtleXMiLCJhdHRycyIsImZvckVhY2giLCJhdHRyaWJ1dGUiLCJub2RlIiwic2V0QXR0cmlidXRlIiwidHJpZ2dlckV2ZW50IiwiZXZlbnRfdHlwZSIsImZpcmVFdmVudCIsImhhc2hJZCIsImV2T2JqIiwiaW5pdEV2ZW50IiwicGFyZW50RWxlbWVudCIsImZvdW5kIiwiaGFzQXR0cmlidXRlIiwicGFyZW50Tm9kZSIsImdldEF0dHJpYnV0ZSIsInNlYXJjaFBhcmVudCIsInBhcmVudENsYXNzIiwiSElERVNIT1dfRVhQQU5EIiwiSElERVNIT1dfQlVUVE9OX0VYUEFORCIsIkhJREVTSE9XX0JVVFRPTl9FWFBBTkRfU1RZTEUiLCJEQVRBX1BSRUZJWF9DTEFTUyIsIkhJREVTSE9XX0JVVFRPTl9FTVBUWV9FTEVNRU5UX1NZTUJPTCIsIkhJREVTSE9XX0JVVFRPTl9FTVBUWV9FTEVNRU5UX1RBRyIsIkFUVFJfSElERVNIT1dfQlVUVE9OX0VNUFRZX0VMRU1FTlQiLCJISURFU0hPV19UT19FWFBBTkRfU1RZTEUiLCJISURFU0hPV19CVVRUT05fTEFCRUxfSUQiLCJISURFU0hPV19UT19FWFBBTkRfSUQiLCJESVNQTEFZX0ZJUlNUX0xPQUQiLCJESVNQTEFZX0ZJUlNUX0xPQURfREVMQVkiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJBVFRSX0VYUEFOREVEIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic2xpY2UiLCJBVFRSX0hJRERFTiIsIkhBU0hfSUQiLCJDT05GSUciLCJhdHRhY2giLCIkbGlzdEhpZGVTaG93cyIsImNhbGwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZXhwYW5kX25vZGUiLCJfc2V0QXR0cmlidXRlczIiLCJpTGlzaWJsZSIsInByZWZpeENsYXNzTmFtZSIsInRvRXhwYW5kIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiZXhwYW5kbW9yZVRleHQiLCJpbm5lckhUTUwiLCJleHBhbmRCdXR0b24iLCJjcmVhdGVFbGVtZW50IiwiZXhwYW5kQnV0dG9uRW1wdHlFbGVtZW50IiwiX2RlZmluZVByb3BlcnR5IiwiQVRUUl9DT05UUk9MIiwiaW5zZXJ0QmVmb3JlIiwiYXBwZW5kQ2hpbGQiLCJmaXJzdENoaWxkIiwic2V0VGltZW91dCIsIl9zZXRBdHRyaWJ1dGVzMyIsIklTX09QRU5FRF9DTEFTUyIsInJlbW92ZUF0dHJpYnV0ZSIsIm1haW4iLCJkZXN0aW5hdGlvbiIsImV2ZW50TmFtZSIsInNlYXJjaFBhcmVudEhhc2hJZCIsImUiLCJ0YXJnZXQiLCJidXR0b25faW4iLCJpZF9leHBhbmRfYnV0dG9uIiwiYnV0dG9uX3RhZyIsInZhbjExeUFjY2Vzc2libGVIaWRlU2hvd0FyaWEiLCJoeF90YWciLCJvbkxvYWQiLCJrZXlDb2RlIiwicGx1Z2luIiwid2luZG93IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFkZEV2ZW50TGlzdGVuZXIiXSwibWFwcGluZ3MiOiJxdkJBS0EsSUFBTUEsV0FBYSxXQUVmLElBQU1DLEVBQVEsR0FJVkEsTUFBTUMsQ0FGVkMsSUFSSixTQUFBRCxFQUFBRSxHQUVBSCxFQUFBQyxHQUFBRSxHQWdCUUMsSUFaSixTQUFBSCxHQUFBLE9BQUFELEVBQUFDLElBT01HLE9BQ1MsU0FBQ0gsR0FBRCxPQUFRRCxFQUFNQyxNQUF2QkksYUFBUyxl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QUNWLE1BQWtCLFVBQWRKLElBSWMsWUFBZEEsR0FBNEIsS0FBT0UsRUFBRVEsU0FBVyxLQUFPUixFQUFFUSxjQUE3RCxHQUhJeEUsYUFBYWtFLEVBQVcsVUFDakIsT0FheEIsS0FLSk8sUUFJWEMsT0FBT0wsNkJBQStCVCxPQUV0QyxJQUFNVyxPQUFTLFNBQVRBLElBQ3FCRyxPQUFPTCwrQkFDZmpDLFNBRWY3RCxTQUFTb0csb0JBQW9CLG1CQUFvQkosSUFHckRoRyxTQUFTcUcsaUJBQWlCLG1CQUFvQkwiLCJmaWxlIjoic2VyaWVzLWRldGFpbHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIEVTMjAxNSBzaW1wbGUgYW5kIGFjY2Vzc2libGUgaGlkZS1zaG93IHN5c3RlbSAoY29sbGFwc2libGUgcmVnaW9ucyksIHVzaW5nIEFSSUFcbiAqIFdlYnNpdGU6IGh0dHBzOi8vdmFuMTF5Lm5ldC9hY2Nlc3NpYmxlLWhpZGUtc2hvdy9cbiAqIExpY2Vuc2UgTUlUOiBodHRwczovL2dpdGh1Yi5jb20vbmljbzMzMzNmci92YW4xMXktYWNjZXNzaWJsZS1oaWRlLXNob3ctYXJpYS9ibG9iL21hc3Rlci9MSUNFTlNFXG4gKi9cbmNvbnN0IGxvYWRDb25maWcgPSAoKSA9PiB7XG5cbiAgICBjb25zdCBDQUNIRSA9IHt9O1xuXG4gICAgY29uc3Qgc2V0ID0gKGlkLCBjb25maWcpID0+IHtcblxuICAgICAgICBDQUNIRVtpZF0gPSBjb25maWc7XG5cbiAgICB9O1xuICAgIGNvbnN0IGdldCA9IChpZCkgPT4gQ0FDSEVbaWRdO1xuICAgIGNvbnN0IHJlbW92ZSA9IChpZCkgPT4gQ0FDSEVbaWRdO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2V0LFxuICAgICAgICBnZXQsXG4gICAgICAgIHJlbW92ZVxuICAgIH1cbn07XG5cbmNvbnN0IERBVEFfSEFTSF9JRCA9ICdkYXRhLWhhc2gtaWQnO1xuXG5jb25zdCBwbHVnaW5Db25maWcgPSBsb2FkQ29uZmlnKCk7XG5cbmNvbnN0IGZpbmRCeUlkID0gKGlkLCBoYXNoKSA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpZH1bJHtEQVRBX0hBU0hfSUR9PVwiJHtoYXNofVwiXWApO1xuXG5jb25zdCBhZGRDbGFzcyA9IChlbCwgY2xhc3NOYW1lKSA9PiB7XG4gICAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7IC8vIElFIDEwK1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLmNsYXNzTmFtZSArPSAnICcgKyBjbGFzc05hbWU7IC8vIElFIDgrXG4gICAgfVxufVxuXG5jb25zdCByZW1vdmVDbGFzcyA9IChlbCwgY2xhc3NOYW1lKSA9PiB7XG4gICAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7IC8vIElFIDEwK1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhefFxcXFxiKScgKyBjbGFzc05hbWUuc3BsaXQoJyAnKS5qb2luKCd8JykgKyAnKFxcXFxifCQpJywgJ2dpJyksICcgJyk7IC8vIElFIDgrXG4gICAgfVxufVxuXG5jb25zdCBoYXNDbGFzcyA9IChlbCwgY2xhc3NOYW1lKSA9PiB7XG4gICAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgICAgICByZXR1cm4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7IC8vIElFIDEwK1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVnRXhwKCcoXnwgKScgKyBjbGFzc05hbWUgKyAnKCB8JCknLCAnZ2knKS50ZXN0KGVsLmNsYXNzTmFtZSk7IC8vIElFIDgrID9cbiAgICB9XG59XG5cbmNvbnN0IHNldEF0dHJpYnV0ZXMgPSAobm9kZSwgYXR0cnMpID0+IHtcbiAgICBPYmplY3RcbiAgICAgICAgLmtleXMoYXR0cnMpXG4gICAgICAgIC5mb3JFYWNoKChhdHRyaWJ1dGUpID0+IHtcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgYXR0cnNbYXR0cmlidXRlXSk7XG4gICAgICAgIH0pO1xufTtcblxuY29uc3QgdHJpZ2dlckV2ZW50ID0gKGVsLCBldmVudF90eXBlKSA9PiB7XG4gICAgaWYgKGVsLmZpcmVFdmVudCkge1xuICAgICAgICBlbC5maXJlRXZlbnQoJ29uJyArIGV2ZW50X3R5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBldk9iaiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudHMnKTtcbiAgICAgICAgZXZPYmouaW5pdEV2ZW50KGV2ZW50X3R5cGUsIHRydWUsIGZhbHNlKTtcbiAgICAgICAgZWwuZGlzcGF0Y2hFdmVudChldk9iaik7XG4gICAgfVxufVxuXG4vKiBnZXRzIGFuIGVsZW1lbnQgZWwsIHNlYXJjaCBpZiBpdCBpcyBlbGVtZW50IHdpdGggY2xhc3Mgb3IgY2hpbGQgb2YgcGFyZW50IGNsYXNzLCByZXR1cm5zIGlkIG9mIHRoZSBlbGVtZW50IGZvdW5kZWQgKi9cbmNvbnN0IHNlYXJjaFBhcmVudEhhc2hJZCA9IChlbCwgaGFzaElkKSA9PiB7XG4gICAgbGV0IGZvdW5kID0gZmFsc2U7XG5cbiAgICBsZXQgcGFyZW50RWxlbWVudCA9IGVsO1xuICAgIHdoaWxlIChwYXJlbnRFbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIHBhcmVudEVsZW1lbnQgJiYgZm91bmQgPT09IGZhbHNlKSB7XG5cbiAgICAgICAgaWYgKHBhcmVudEVsZW1lbnQuaGFzQXR0cmlidXRlKGhhc2hJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGZvdW5kID09PSB0cnVlKSB7XG4gICAgICAgIHJldHVybiBwYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZShoYXNoSWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG59XG5jb25zdCBzZWFyY2hQYXJlbnQgPSAoZWwsIHBhcmVudENsYXNzLCBoYXNoSWQpID0+IHtcbiAgICBsZXQgZm91bmQgPSBmYWxzZTtcblxuICAgIGxldCBwYXJlbnRFbGVtZW50ID0gZWw7XG4gICAgd2hpbGUgKHBhcmVudEVsZW1lbnQgJiYgZm91bmQgPT09IGZhbHNlKSB7XG4gICAgICAgIGlmIChoYXNDbGFzcyhwYXJlbnRFbGVtZW50LCBwYXJlbnRDbGFzcykgPT09IHRydWUgJiYgcGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoREFUQV9IQVNIX0lEKSA9PT0gaGFzaElkKSB7XG4gICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudC5wYXJlbnROb2RlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChmb3VuZCA9PT0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gcGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn1cblxuY29uc3QgcGx1Z2luID0gKGNvbmZpZyA9IHt9KSA9PiB7XG5cbiAgICBjb25zdCBDT05GSUcgPSB7XG4gICAgICAgIEhJREVTSE9XX0VYUEFORDogJ2pzLWV4cGFuZG1vcmUnLFxuICAgICAgICBISURFU0hPV19CVVRUT05fRVhQQU5EOiAnanMtZXhwYW5kbW9yZS1idXR0b24nLFxuICAgICAgICBISURFU0hPV19CVVRUT05fRVhQQU5EX1NUWUxFOiAnZXhwYW5kbW9yZV9fYnV0dG9uJyxcbiAgICAgICAgSElERVNIT1dfQlVUVE9OX0xBQkVMX0lEOiAnbGFiZWxfZXhwYW5kXycsXG5cbiAgICAgICAgREFUQV9QUkVGSVhfQ0xBU1M6ICdkYXRhLWhpZGVzaG93LXByZWZpeC1jbGFzcycsXG5cbiAgICAgICAgSElERVNIT1dfQlVUVE9OX0VNUFRZX0VMRU1FTlRfU1lNQk9MOiAnZXhwYW5kbW9yZV9fc3ltYm9sJyxcbiAgICAgICAgSElERVNIT1dfQlVUVE9OX0VNUFRZX0VMRU1FTlRfVEFHOiAnc3BhbicsXG4gICAgICAgIEFUVFJfSElERVNIT1dfQlVUVE9OX0VNUFRZX0VMRU1FTlQ6ICdhcmlhLWhpZGRlbicsXG5cbiAgICAgICAgSElERVNIT1dfVE9fRVhQQU5EX0lEOiAnZXhwYW5kXycsXG4gICAgICAgIEhJREVTSE9XX1RPX0VYUEFORF9TVFlMRTogJ2V4cGFuZG1vcmVfX3RvX2V4cGFuZCcsXG5cbiAgICAgICAgLypcbiAgICAgICAgIHJlY29tbWVuZGVkIHNldHRpbmdzIGJ5IGExMXkgZXhwZXJ0XG4gICAgICAgICovXG4gICAgICAgIEFUVFJfQ09OVFJPTDogJ2RhdGEtY29udHJvbHMnLFxuICAgICAgICBBVFRSX0VYUEFOREVEOiAnYXJpYS1leHBhbmRlZCcsXG4gICAgICAgIEFUVFJfTEFCRUxMRURCWTogJ2RhdGEtbGFiZWxsZWRieScsXG4gICAgICAgIEFUVFJfSElEREVOOiAnZGF0YS1oaWRkZW4nLFxuXG4gICAgICAgIElTX09QRU5FRF9DTEFTUzogJ2lzLW9wZW5lZCcsXG5cbiAgICAgICAgRElTUExBWV9GSVJTVF9MT0FEOiAnanMtZmlyc3RfbG9hZCcsXG4gICAgICAgIERJU1BMQVlfRklSU1RfTE9BRF9ERUxBWTogJzE1MDAnLFxuICAgICAgICAuLi5jb25maWdcbiAgICB9O1xuXG4gICAgY29uc3QgSEFTSF9JRCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzIpLnNsaWNlKDIsIDEyKTtcblxuICAgIHBsdWdpbkNvbmZpZy5zZXQoSEFTSF9JRCwgQ09ORklHKTtcblxuXG4gICAgLyoqIEZpbmQgYWxsIGV4cGFuZCBpbnNpZGUgYSBjb250YWluZXJcbiAgICAgKiBAcGFyYW0gIHtOb2RlfSBub2RlIERlZmF1bHQgZG9jdW1lbnRcbiAgICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICAgKi9cbiAgICBjb25zdCAkbGlzdEhpZGVTaG93cyA9IChub2RlID0gZG9jdW1lbnQpID0+IFtdLnNsaWNlLmNhbGwobm9kZS5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIENPTkZJRy5ISURFU0hPV19FWFBBTkQpKTsgLy9bLi4ubm9kZS5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIENPTkZJRy5ISURFU0hPV19FWFBBTkQpXTsgLy8gdGhhdCBkb2VzIG5vdCB3b3JrIG9uIElFIHdoZW4gdHJhbnNwaWxlZCA6LShcblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGV4cGFuZHMgZm9yIGEgY29udGFpbmVyXG4gICAgICogQHBhcmFtICB7Tm9kZX0gbm9kZVxuICAgICAqL1xuICAgIGNvbnN0IGF0dGFjaCA9IChub2RlKSA9PiB7XG5cbiAgICAgICAgJGxpc3RIaWRlU2hvd3Mobm9kZSlcbiAgICAgICAgICAgIC5mb3JFYWNoKChleHBhbmRfbm9kZSkgPT4ge1xuXG4gICAgICAgICAgICAgICAgbGV0IGlMaXNpYmxlID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzMikuc2xpY2UoMiwgMTIpO1xuICAgICAgICAgICAgICAgIC8vIGxldCBwcmVmaXhDbGFzc05hbWUgPSB0eXBlb2YgZXhwYW5kX25vZGUuZ2V0QXR0cmlidXRlKERBVEFfUFJFRklYX0NMQVNTKSAhPT0gJ3VuZGVmaW5lZCcgPyBleHBhbmRfbm9kZS5nZXRBdHRyaWJ1dGUoREFUQV9QUkVGSVhfQ0xBU1MpICsgJy0nIDogJycgOyAvLyBJRTExK1xuICAgICAgICAgICAgICAgIGxldCBwcmVmaXhDbGFzc05hbWUgPSBleHBhbmRfbm9kZS5oYXNBdHRyaWJ1dGUoQ09ORklHLkRBVEFfUFJFRklYX0NMQVNTKSA9PT0gdHJ1ZSA/IGV4cGFuZF9ub2RlLmdldEF0dHJpYnV0ZShDT05GSUcuREFUQV9QUkVGSVhfQ0xBU1MpICsgJy0nIDogJyc7XG4gICAgICAgICAgICAgICAgbGV0IHRvRXhwYW5kID0gZXhwYW5kX25vZGUubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIGxldCBleHBhbmRtb3JlVGV4dCA9IGV4cGFuZF9ub2RlLmlubmVySFRNTDtcbiAgICAgICAgICAgICAgICBsZXQgZXhwYW5kQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkJVVFRPTlwiKTtcbiAgICAgICAgICAgICAgICBsZXQgZXhwYW5kQnV0dG9uRW1wdHlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChDT05GSUcuSElERVNIT1dfQlVUVE9OX0VNUFRZX0VMRU1FTlRfVEFHKTtcblxuICAgICAgICAgICAgICAgIGV4cGFuZF9ub2RlLnNldEF0dHJpYnV0ZShEQVRBX0hBU0hfSUQsIEhBU0hfSUQpO1xuXG4gICAgICAgICAgICAgICAgLy8gZW1wdHkgZWxlbWVudCBmb3Igc3ltYm9sXG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoZXhwYW5kQnV0dG9uRW1wdHlFbGVtZW50LCBwcmVmaXhDbGFzc05hbWUgKyBDT05GSUcuSElERVNIT1dfQlVUVE9OX0VNUFRZX0VMRU1FTlRfU1lNQk9MKTtcbiAgICAgICAgICAgICAgICBzZXRBdHRyaWJ1dGVzKGV4cGFuZEJ1dHRvbkVtcHR5RWxlbWVudCwge1xuICAgICAgICAgICAgICAgICAgICBbQ09ORklHLkFUVFJfSElERVNIT1dfQlVUVE9OX0VNUFRZX0VMRU1FTlRdOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBbREFUQV9IQVNIX0lEXTogSEFTSF9JRFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gY2xlYXIgZWxlbWVudCBiZWZvcmUgYWRkaW5nIGJ1dHRvbiB0byBpdFxuICAgICAgICAgICAgICAgIGV4cGFuZF9ub2RlLmlubmVySFRNTCA9ICcnO1xuXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIGEgYnV0dG9uIHdpdGggYWxsIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICBhZGRDbGFzcyhleHBhbmRCdXR0b24sIHByZWZpeENsYXNzTmFtZSArIENPTkZJRy5ISURFU0hPV19CVVRUT05fRVhQQU5EX1NUWUxFKTtcbiAgICAgICAgICAgICAgICBhZGRDbGFzcyhleHBhbmRCdXR0b24sIENPTkZJRy5ISURFU0hPV19CVVRUT05fRVhQQU5EKTtcbiAgICAgICAgICAgICAgICBzZXRBdHRyaWJ1dGVzKGV4cGFuZEJ1dHRvbiwge1xuICAgICAgICAgICAgICAgICAgICBbQ09ORklHLkFUVFJfQ09OVFJPTF06IENPTkZJRy5ISURFU0hPV19UT19FWFBBTkRfSUQgKyBpTGlzaWJsZSxcbiAgICAgICAgICAgICAgICAgICAgW0NPTkZJRy5BVFRSX0VYUEFOREVEXTogJ2ZhbHNlJyxcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogQ09ORklHLkhJREVTSE9XX0JVVFRPTl9MQUJFTF9JRCArIGlMaXNpYmxlLFxuICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICBbREFUQV9IQVNIX0lEXTogSEFTSF9JRFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGV4cGFuZEJ1dHRvbi5pbm5lckhUTUwgPSBleHBhbmRtb3JlVGV4dDtcblxuICAgICAgICAgICAgICAgIC8vIEJ1dHRvbiBnb2VzIGludG8gbm9kZVxuICAgICAgICAgICAgICAgIGV4cGFuZF9ub2RlLmFwcGVuZENoaWxkKGV4cGFuZEJ1dHRvbik7XG4gICAgICAgICAgICAgICAgZXhwYW5kQnV0dG9uLmluc2VydEJlZm9yZShleHBhbmRCdXR0b25FbXB0eUVsZW1lbnQsIGV4cGFuZEJ1dHRvbi5maXJzdENoaWxkKTtcblxuICAgICAgICAgICAgICAgIC8vIHRvIGV4cGFuZCBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgICAgc2V0QXR0cmlidXRlcyh0b0V4cGFuZCwge1xuICAgICAgICAgICAgICAgICAgICBbQ09ORklHLkFUVFJfTEFCRUxMRURCWV06IENPTkZJRy5ISURFU0hPV19CVVRUT05fTEFCRUxfSUQgKyBpTGlzaWJsZSxcbiAgICAgICAgICAgICAgICAgICAgW0NPTkZJRy5BVFRSX0hJRERFTl06ICd0cnVlJyxcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogQ09ORklHLkhJREVTSE9XX1RPX0VYUEFORF9JRCArIGlMaXNpYmxlLFxuICAgICAgICAgICAgICAgICAgICBbREFUQV9IQVNIX0lEXTogSEFTSF9JRFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gYWRkIGRlbGF5IGlmIERJU1BMQVlfRklSU1RfTE9BRFxuICAgICAgICAgICAgICAgIGFkZENsYXNzKHRvRXhwYW5kLCBwcmVmaXhDbGFzc05hbWUgKyBDT05GSUcuSElERVNIT1dfVE9fRVhQQU5EX1NUWUxFKTtcbiAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3ModG9FeHBhbmQsIENPTkZJRy5ESVNQTEFZX0ZJUlNUX0xPQUQpID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyh0b0V4cGFuZCwgQ09ORklHLkRJU1BMQVlfRklSU1RfTE9BRCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIENPTkZJRy5ESVNQTEFZX0ZJUlNUX0xPQURfREVMQVkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHF1aWNrIHRpcCB0byBvcGVuXG4gICAgICAgICAgICAgICAgaWYgKGhhc0NsYXNzKHRvRXhwYW5kLCBDT05GSUcuSVNfT1BFTkVEX0NMQVNTKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhleHBhbmRCdXR0b24sIENPTkZJRy5JU19PUEVORURfQ0xBU1MpO1xuICAgICAgICAgICAgICAgICAgICBleHBhbmRCdXR0b24uc2V0QXR0cmlidXRlKENPTkZJRy5BVFRSX0VYUEFOREVELCAndHJ1ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKHRvRXhwYW5kLCBDT05GSUcuSVNfT1BFTkVEX0NMQVNTKTtcbiAgICAgICAgICAgICAgICAgICAgdG9FeHBhbmQucmVtb3ZlQXR0cmlidXRlKENPTkZJRy5BVFRSX0hJRERFTik7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG5cblxuXG4gICAgfTtcblxuXG4gICAgLypjb25zdCBkZXN0cm95ID0gKG5vZGUpID0+IHtcbiAgICAgICAgJGxpc3RIaWRlU2hvd3Mobm9kZSlcbiAgICAgICAgLmZvckVhY2goKGV4cGFuZF9ub2RlKSA9PiB7XG4gICAgICAgIH0pO1xuICAgIH07Ki9cblxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYXR0YWNoXG4gICAgICAgIC8qLFxuICAgICAgICAgICAgICAgIGRlc3Ryb3kqL1xuICAgIH1cbn07XG5cbmNvbnN0IG1haW4gPSAoKSA9PiB7XG5cbiAgICAvKiBsaXN0ZW5lcnMgZm9yIGFsbCBjb25maWdzICovXG4gICAgWydjbGljaycsICdrZXlkb3duJ11cbiAgICAuZm9yRWFjaChldmVudE5hbWUgPT4ge1xuXG4gICAgICAgIGRvY3VtZW50LmJvZHlcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZSA9PiB7XG5cbiAgICAgICAgICAgICAgICBsZXQgaGFzaElkID0gc2VhcmNoUGFyZW50SGFzaElkKGUudGFyZ2V0LCBEQVRBX0hBU0hfSUQpOyAvL2UudGFyZ2V0LmRhdGFzZXQuaGFzaElkO1xuICAgICAgICAgICAgICAgIC8vIHNlYXJjaCBpZiBjbGljayBvbiBidXR0b24gb3Igb24gZWxlbWVudCBpbiBhIGJ1dHRvbiBjb250YWlucyBkYXRhLWhhc2gtaWQgKGl0IGlzIG5lZWRlZCB0byBsb2FkIGNvbmZpZyBhbmQga25vdyB3aGljaCBjbGFzcyB0byBzZWFyY2gpXG5cbiAgICAgICAgICAgICAgICBpZiAoaGFzaElkICE9PSAnJykge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGxvYWRpbmcgY29uZmlnIGZyb20gZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICBsZXQgQ09ORklHID0gcGx1Z2luQ29uZmlnLmdldChoYXNoSWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNlYXJjaCBpZiBjbGljayBvbiBidXR0b24gb3Igb24gZWxlbWVudCBpbiBhIGJ1dHRvbiAoZml4IGZvciBDaHJvbWUpXG4gICAgICAgICAgICAgICAgICAgIGxldCBpZF9leHBhbmRfYnV0dG9uID0gc2VhcmNoUGFyZW50KGUudGFyZ2V0LCBDT05GSUcuSElERVNIT1dfQlVUVE9OX0VYUEFORCwgaGFzaElkKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNsaWNrIG9uIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBpZiAoaWRfZXhwYW5kX2J1dHRvbiAhPT0gJycgJiYgZXZlbnROYW1lID09PSAnY2xpY2snKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYnV0dG9uX3RhZyA9IGZpbmRCeUlkKGlkX2V4cGFuZF9idXR0b24sIGhhc2hJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVzdGluYXRpb24gPSBmaW5kQnlJZChidXR0b25fdGFnLmdldEF0dHJpYnV0ZShDT05GSUcuQVRUUl9DT05UUk9MKSwgaGFzaElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBldGF0X2J1dHRvbiA9IGJ1dHRvbl90YWcuZ2V0QXR0cmlidXRlKENPTkZJRy5BVFRSX0VYUEFOREVEKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgY2xvc2VkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXRhdF9idXR0b24gPT09ICdmYWxzZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25fdGFnLnNldEF0dHJpYnV0ZShDT05GSUcuQVRUUl9FWFBBTkRFRCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoYnV0dG9uX3RhZywgQ09ORklHLklTX09QRU5FRF9DTEFTUyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb24ucmVtb3ZlQXR0cmlidXRlKENPTkZJRy5BVFRSX0hJRERFTik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbl90YWcuc2V0QXR0cmlidXRlKENPTkZJRy5BVFRSX0VYUEFOREVELCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoYnV0dG9uX3RhZywgQ09ORklHLklTX09QRU5FRF9DTEFTUyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb24uc2V0QXR0cmlidXRlKENPTkZJRy5BVFRSX0hJRERFTiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBjbGljayBvbiBoeCAoZml4IGZvciB2b2ljZW92ZXIgPSBjbGljayBvciBrZXlkb3duIG9uIGh4ID0+IGNsaWNrIG9uIGJ1dHRvbi5cbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBtYWtlcyBubyBzZW5zZSwgYnV0IHNvbWVib2R5IGhhcyB0byBkbyB0aGUgam9iIHRvIG1ha2UgaXQgZnVja2luZyB3b3JrXG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNDbGFzcyhlLnRhcmdldCwgQ09ORklHLkhJREVTSE9XX0VYUEFORCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoeF90YWcgPSBlLnRhcmdldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBidXR0b25faW4gPSBoeF90YWcucXVlcnlTZWxlY3RvcignLicgKyBDT05GSUcuSElERVNIT1dfQlVUVE9OX0VYUEFORClcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGh4X3RhZyAhPSBidXR0b25faW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnROYW1lID09PSAnY2xpY2snKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudChidXR0b25faW4sICdjbGljaycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudE5hbWUgPT09ICdrZXlkb3duJyAmJiAoMTMgPT09IGUua2V5Q29kZSB8fCAzMiA9PT0gZS5rZXlDb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQoYnV0dG9uX2luLCAnY2xpY2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfSwgdHJ1ZSk7XG5cblxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHBsdWdpbjtcblxufTtcblxud2luZG93LnZhbjExeUFjY2Vzc2libGVIaWRlU2hvd0FyaWEgPSBtYWluKCk7XG5cbmNvbnN0IG9uTG9hZCA9ICgpID0+IHtcbiAgICBjb25zdCBleHBhbmRfZGVmYXVsdCA9IHdpbmRvdy52YW4xMXlBY2Nlc3NpYmxlSGlkZVNob3dBcmlhKCk7XG4gICAgZXhwYW5kX2RlZmF1bHQuYXR0YWNoKCk7XG5cbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgb25Mb2FkKTtcbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIG9uTG9hZCk7XG5cblxuIl19